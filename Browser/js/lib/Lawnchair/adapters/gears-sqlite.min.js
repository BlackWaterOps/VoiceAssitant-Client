(function(){if(window.google&&google.gears)return;var e=null;if(typeof GearsFactory!="undefined")e=new GearsFactory;else try{e=new ActiveXObject("Gears.Factory");e.getBuildInfo().indexOf("ie_mobile")!=-1&&e.privateSetGlobalObject(this)}catch(t){if(typeof navigator.mimeTypes!="undefined"&&navigator.mimeTypes["application/x-googlegears"]){e=document.createElement("object");e.style.display="none";e.width=0;e.height=0;e.type="application/x-googlegears";document.documentElement.appendChild(e)}}if(!e)return;window.google||(google={});google.gears||(google.gears={factory:e})})();Lawnchair.extend({init:function(e){var t=this,n=t.merge,r=typeof arguments[0]=="string"?{table:e}:e;this.name=n("Lawnchair",r.name);this.table=n("field",r.table);this.db=google.gears.factory.create("beta.database");this.db.open(this.name);this.db.execute("create table if not exists "+this.table+" (id NVARCHAR(32) UNIQUE PRIMARY KEY, value TEXT, timestamp REAL)")},save:function(e,t){var n=this,r=function(e,t){var r=e.key==undefined?n.uuid():e.key;delete e.key;var i=n.db.execute("INSERT INTO "+n.table+" (id, value, timestamp) VALUES (?,?,?)",[r,n.serialize(e),n.now()]);if(t!=undefined){e.key=r;t(e)}},i=function(e,t,r){n.db.execute("UPDATE "+n.table+" SET value=?, timestamp=? WHERE id=?",[n.serialize(t),n.now(),e]);if(r!=undefined){t.key=e;r(t)}};e.key==undefined?r(e,t):this.get(e.key,function(n){var s=n!=null;if(s){var o=e.key;delete e.key;i(o,e,t)}else r(e,t)})},get:function(e,t){var n=this.db.execute("SELECT * FROM "+this.table+" WHERE id = ?",[e]);if(n.isValidRow()){var r=this.deserialize(n.field(1));r.key=e;n.close();t(r)}else{n.close();t(null)}},all:function(e){var t=this.terseToVerboseCallback(e),n=this.db.execute("SELECT * FROM "+this.table),r=[],i;while(n.isValidRow()){i=this.deserialize(n.field(1));i.key=n.field(0);r.push(i);n.next()}n.close();t(r)},remove:function(e,t){this.db.execute("DELETE FROM "+this.table+" WHERE id = ?",[typeof e=="string"?e:e.key]);t&&t()},nuke:function(e){this.db.execute("DELETE FROM "+this.table);e&&e();return this}});