Lawnchair.adapter("chrome-storage",function(){var e=chrome.storage.local,t=function(t){return{key:t+"._index_",all:function(t){var n=this,r=function(){var t=JSON.stringify([]),r={};r[n.key]=t;e.set(r);t=JSON.parse(t);return t};e.get(this.key,function(e){var n;if(Object.keys(e).length>0)for(itemKey in e){n=e[itemKey];n&&(n=JSON.parse(n));if(n===null||typeof n=="undefined")n=r();t&&t(n)}else{n=r();t(n)}})},add:function(t){this.all(function(n){n.push(t);var r={};r[this.key]=JSON.stringify(n);e.set(r)})},del:function(t){var n=[];this.all(function(i){for(var s=0,o=i.length;s<o;s++)i[s]!=t&&n.push(i[s]);var u={};u[this.key]=JSON.stringify(n);e.set(u)})},find:function(e,t){this.all(function(n){for(var r=0,i=n.length;r<i;r++)e===n[r]&&t&&t(r);t&&t(!1)})}}};return{valid:function(){return!!e&&function(){var t=!0,n=Math.random();n=""+n+"";try{var r={};r[n]=n;e.set(r)}catch(i){t=!1}e.remove(n);return t}()},init:function(e,n){this.indexer=t(this.name);n&&this.fn(this.name,n).call(this,this)},save:function(t,n){var r=t.key?this.name+"."+t.key:this.name+"."+this.uuid();this.indexer.find(r)===!1&&this.indexer.add(r);delete t.key;var i={};i[r]=JSON.stringify(t);e.set(i);t.key=r.slice(this.name.length+1);n&&this.lambda(n).call(this,t);return this},batch:function(e,t){var n=[];for(var r=0,i=e.length;r<i;r++)this.save(e[r],function(e){n.push(e)});t&&this.lambda(t).call(this,n);return this},keys:function(e){if(e){var t=this,n=this.name,r;this.indexer.all(function(i){r=i.map(function(e){return e.replace(n+".","")});t.fn("keys",e).call(t,r)})}return this},get:function(t,n){var r=this,i;if(this.isArray(t)){var s=[];for(var o=0,u=t.length;o<u;o++){var a=this.name+"."+t[o];e.get(a,function(e){if(e)for(itemKey in e){i=e[itemKey];i=JSON.parse(i);i.key=itemKey.replace(r.name+".","");s.push(i)}o==u&&n&&r.lambda(n).call(r,s)})}}else{var a=this.name+"."+t;e.get(a,function(e){if(e)for(itemKey in e){i=e[itemKey];i=JSON.parse(i);i.key=itemKey.replace(r.name+".","")}n&&r.lambda(n).call(r,i)})}return this},exists:function(e,t){var n=this;this.indexer.find(this.name+"."+e,function(e){e=e===!1?!1:!0;n.lambda(t).call(n,e)});return this},all:function(t){var n=this;this.indexer.all(function(r){var i=[],s,o;if(r.length>0)for(var u=0,a=r.length;u<a;u++)e.get(r[u],function(e){for(o in e){s=JSON.parse(e[o]);s.key=o.replace(n.name+".","");i.push(s)}u==a&&t&&n.fn(n.name,t).call(n,i)});else t&&n.fn(n.name,t).call(n,i)});return this},remove:function(t,n){var r=this.name+"."+(t.key?t.key:t);this.indexer.del(r);e.remove(r);n&&this.lambda(n).call(this);return this},nuke:function(e){this.all(function(t){for(var n=0,r=t.length;n<r;n++){t[n]=""+t[n]+"";this.remove(t[n])}e&&this.lambda(e).call(this)});return this}}}());