Lawnchair.adapter("webkit-sqlite",function(){var e=function(e,t){console.log("error in sqlite adaptor!",e,t)},t=function(){return new Date};Function.prototype.bind||(Function.prototype.bind=function(e){var t=[].slice,n=t.call(arguments,1),r=this,i=function(){},s=function(){return r.apply(this instanceof i?this:e||{},n.concat(t.call(arguments)))};i.prototype=r.prototype;s.prototype=new i;return s});return{valid:function(){return!!window.openDatabase},init:function(t,n){var r=this,i=r.fn(r.name,n),s="CREATE TABLE IF NOT EXISTS "+this.record+" (id NVARCHAR(32) UNIQUE PRIMARY KEY, value TEXT, timestamp REAL)",o=function(){return i.call(r,r)};this.db=openDatabase(this.name,"1.0.0",this.name,65536);this.db.transaction(function(t){t.executeSql(s,[],o,e)})},keys:function(t){var n=this.lambda(t),r=this,i="SELECT id FROM "+this.record+" ORDER BY timestamp DESC";this.db.transaction(function(t){var s=function(e,t){if(t.rows.length==0)n.call(r,[]);else{var i=[];for(var s=0,o=t.rows.length;s<o;s++)i.push(t.rows.item(s).id);n.call(r,i)}};t.executeSql(i,[],s,e)});return this},save:function(n,r){var i=this,s=n.key||i.uuid(),o="INSERT INTO "+this.record+" (value, timestamp, id) VALUES (?,?,?)",u="UPDATE "+this.record+" SET value=?, timestamp=? WHERE id=?",a=function(){if(r){n.key=s;i.lambda(r).call(i,n)}},f=[t(),s];i.exists(n.key,function(t){i.db.transaction(function(r){var i=function(t){f.unshift(JSON.stringify(t));r.executeSql(o,f,a,e)},s=function(t){delete t.key;f.unshift(JSON.stringify(t));r.executeSql(u,f,a,e)};t?s(n):i(n)})});return this},batch:function(e,t){var n=[],r=!1,i=this,s=function(t){n.push(t);r=n.length===e.length},o=setInterval(function(){if(r){t&&i.lambda(t).call(i,n);clearInterval(o)}},200);for(var u=0,a=e.length;u<a;u++)this.save(e[u],s);return this},get:function(t,n){var r=this,i="";this.isArray(t)?i="SELECT id, value FROM "+this.record+" WHERE id IN ('"+t.join("','")+"')":i="SELECT id, value FROM "+this.record+" WHERE id = '"+t+"'";var s=function(e,i){var s=null,o=[];if(i.rows.length)for(var u=0,a=i.rows.length;u<a;u++){s=JSON.parse(i.rows.item(u).value);s.key=i.rows.item(u).id;o.push(s)}r.isArray(t)||(o=o.length?o[0]:null);n&&r.lambda(n).call(r,o)};this.db.transaction(function(t){t.executeSql(i,[],s,e)});return this},exists:function(t,n){var r="SELECT * FROM "+this.record+" WHERE id = ?",i=this,s=function(e,t){n&&i.fn("exists",n).call(i,t.rows.length>0)};this.db.transaction(function(n){n.executeSql(r,[t],s,e)});return this},all:function(t){var n=this,r="SELECT * FROM "+this.record,i=[],s=this.fn(this.name,t)||undefined,o=function(e,t){if(t.rows.length!=0)for(var r=0,o=t.rows.length;r<o;r++){var u=JSON.parse(t.rows.item(r).value);u.key=t.rows.item(r).id;i.push(u)}s&&s.call(n,i)};this.db.transaction(function(t){t.executeSql(r,[],o,e)});return this},remove:function(t,n){var r=this,i=typeof t=="string"?t:t.key,s="DELETE FROM "+this.record+" WHERE id = ?",o=function(){n&&r.lambda(n).call(r)};this.db.transaction(function(t){t.executeSql(s,[i],o,e)});return this},nuke:function(t){var n="DELETE FROM "+this.record,r=this,i=t?function(){r.lambda(t).call(r)}:function(){};this.db.transaction(function(t){t.executeSql(n,[],i,e)});return this}}}());